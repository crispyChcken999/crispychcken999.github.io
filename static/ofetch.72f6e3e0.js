import{d as e}from"./destr.d0012d9a.js";import{d as t,e as o}from"./ufo.511bd6cf.js";class s extends Error{constructor(){super(...arguments),this.name="FetchError"}}const n=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function r(e="GET"){return n.has(e.toUpperCase())}const a=new Set(["image/svg","application/xml","application/xhtml","application/html"]),i=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;const p=new Set([408,409,425,429,500,502,503,504]);const c=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),u=function n(c){const{fetch:u,Headers:f}=c;function d(e){const t=e.error&&"AbortError"===e.error.name||!1;if(!1!==e.options.retry&&!t){let t;t="number"==typeof e.options.retry?e.options.retry:r(e.options.method)?0:1;const o=e.response&&e.response.status||500;if(t>0&&p.has(o))return y(e.request,{...e.options,retry:t-1})}const o=function(e,t,o){let n="";t&&(n=t.message),e&&o?n=`${n} (${o.status} ${o.statusText} (${e.toString()}))`:e&&(n=`${n} (${e.toString()})`);const r=new s(n);return Object.defineProperty(r,"request",{get:()=>e}),Object.defineProperty(r,"response",{get:()=>o}),Object.defineProperty(r,"data",{get:()=>o&&o._data}),Object.defineProperty(r,"status",{get:()=>o&&o.status}),Object.defineProperty(r,"statusText",{get:()=>o&&o.statusText}),Object.defineProperty(r,"statusCode",{get:()=>o&&o.status}),Object.defineProperty(r,"statusMessage",{get:()=>o&&o.statusText}),r}(e.request,e.error,e.response);throw Error.captureStackTrace&&Error.captureStackTrace(o,y),o}const y=async function(s,n={}){const p={request:s,options:{...c.defaults,...n},response:void 0,error:void 0};p.options.onRequest&&await p.options.onRequest(p),"string"==typeof p.request&&(p.options.baseURL&&(p.request=t(p.request,p.options.baseURL)),(p.options.query||p.options.params)&&(p.request=o(p.request,{...p.options.params,...p.options.query})),p.options.body&&r(p.options.method)&&function(e){if(void 0===e)return!1;const t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON)}(p.options.body)&&(p.options.body="string"==typeof p.options.body?p.options.body:JSON.stringify(p.options.body),p.options.headers=new f(p.options.headers),p.options.headers.has("content-type")||p.options.headers.set("content-type","application/json"),p.options.headers.has("accept")||p.options.headers.set("accept","application/json"))),p.response=await u(p.request,p.options).catch((async e=>(p.error=e,p.options.onRequestError&&await p.options.onRequestError(p),d(p))));const y=(p.options.parseResponse?"json":p.options.responseType)||function(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return i.test(t)?"json":a.has(t)||t.startsWith("text/")?"text":"blob"}(p.response.headers.get("content-type")||"");if("json"===y){const t=await p.response.text(),o=p.options.parseResponse||e;p.response._data=o(t)}else p.response._data="stream"===y?p.response.body:await p.response[y]();return p.options.onResponse&&await p.options.onResponse(p),p.response.status>=400&&p.response.status<600?(p.options.onResponseError&&await p.options.onResponseError(p),d(p)):p.response},l=function(e,t){return y(e,t).then((e=>e._data))};return l.raw=y,l.native=u,l.create=(e={})=>n({...c,defaults:{...c.defaults,...e}}),l}({fetch:c.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),Headers:c.Headers}),f=u;export{f as $};
